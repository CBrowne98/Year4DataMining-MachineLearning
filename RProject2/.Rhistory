df$V2[df$V2=='med'] <- 2
df$V2[df$V2=='low'] <- 1
df$V3[df$V3=='5more'] <- 5
df$V4[df$V4=='more'] <- 5
df$V5[df$V5=='small'] <- 1
df$V5[df$V5=='med'] <- 2
df$V5[df$V5=='big'] <- 3
df$V6[df$V6=='low'] <- 1
df$V6[df$V6=='med'] <- 2
df$V6[df$V6=='high'] <-3
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
car_rand <- df[order(runif(150)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
print(df)
df$V7[df$V7=="unacc"] <- 1
View(car)
View(car)
car <- read.csv("C:/Users/major/Downloads/car (2).data", header=FALSE)
View(car)
df <- car
df$V1[df$V1=='vhigh'] <- 4
df$V1[df$V1=='high'] <- 3
df$V1[df$V1=='med'] <- 2
df$V1[df$V1=='low'] <- 1
df$V2[df$V2=='vhigh'] <- 4
df$V2[df$V2=='high'] <- 3
df$V2[df$V2=='med'] <- 2
df$V2[df$V2=='low'] <- 1
df$V3[df$V3=='5more'] <- 5
df$V4[df$V4=='more'] <- 5
df$V5[df$V5=='small'] <- 1
df$V5[df$V5=='med'] <- 2
df$V5[df$V5=='big'] <- 3
df$V6[df$V6=='low'] <- 1
df$V6[df$V6=='med'] <- 2
df$V6[df$V6=='high'] <-3
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
print(df)
car_rand <- df[order(runif(150)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
print(df)
car_rand <- df[order(runif(150)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
car_z <- as.data.frame(scale(car_rand[-5]))
df<âˆ’lapply(df,as.numeric)
car_rand <- df[order(runif(150)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
car_rand <- df[order(runif(150)), ]
df <- car
df$V1[df$V1=='vhigh'] <- 4
df$V1[df$V1=='high'] <- 3
df$V1[df$V1=='med'] <- 2
df$V1[df$V1=='low'] <- 1
df$V2[df$V2=='vhigh'] <- 4
df$V2[df$V2=='high'] <- 3
df$V2[df$V2=='med'] <- 2
df$V2[df$V2=='low'] <- 1
df$V3[df$V3=='5more'] <- 5
df$V4[df$V4=='more'] <- 5
df$V5[df$V5=='small'] <- 1
df$V5[df$V5=='med'] <- 2
df$V5[df$V5=='big'] <- 3
df$V6[df$V6=='low'] <- 1
df$V6[df$V6=='med'] <- 2
df$V6[df$V6=='high'] <-3
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
car_rand <- df[order(runif(150)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
library(gmodels)
data(iris)
set.seed(1)
iris_rand <- iris[order(runif(150)), ]
iris_z <- as.data.frame(scale(iris_rand[-5]))
# four needed for kNN
iris_train <- iris_z[1:100,]
iris_test <- iris_z[101:150,]
iris_train_species <- iris_rand[1:100, 5]
iris_test_species <- iris_rand[101:150, 5]
?knn
predictions = knn(iris_train, iris_test, cl=iris_train_species ,
k = 3)
CrossTable(predictions, iris_test_species,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
cm <- table(predictions, iris_test_species)
car_z <- as.data.frame(scale(car_rand[-5]))
# four needed for kNN
car_train <- car_z[1:100,]
car_rand <- df[order(runif(1728)), ]
car_z <- as.data.frame(scale(car_rand[-5]))
iris_z <- as.data.frame(scale(iris_rand[-5]))
iris_z <- as.data.frame(scale(iris_rand[-7]))
car_z <- as.data.frame(scale(car_rand[-7]))
car_z <- as.data.frame(scale(car_rand[-6]))
# four needed for kNN
car_train <- df[1:100,]
car_test <- df[101:150,]
car_train_species <- car_rand[1:100, 5]
car_test_species <- car_rand[101:150, 5]
car_z <- as.data.frame(scale(car_rand[-7]))
car_z <- as.data.frame(scale(car_rand[-6]))
car_test_value <- car_rand[1501: 1728, 7]
predictions = knn(car_train, car_test, cl=car_train_value, k=3)
car_train <- df[1:100, ]
car_test <- df[1501:1728, ]
car_train_value <- df[1:100, 7]
car_test_value <- df[1501: 1728, 7]
predictions = knn(car_train, car_test, cl=car_train_value, k=3)
CrossTable(predictions, car_test_value,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
sum(diag(cm))/sum(cm)
library(gmodels)
data(iris)
set.seed(1)
iris_rand <- iris[order(runif(150)), ]
iris_z <- as.data.frame(scale(iris_rand[-5]))
# four needed for kNN
iris_train <- iris_z[1:100,]
iris_test <- iris_z[101:150,]
iris_train_species <- iris_rand[1:100, 5]
iris_test_species <- iris_rand[101:150, 5]
?knn
predictions = knn(iris_train, iris_test, cl=iris_train_species ,
k = 3)
CrossTable(predictions, iris_test_species,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
cm <- table(predictions, iris_test_species)
sum(diag(cm))/sum(cm)
CrossTable(predictions, car_test_value,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
cm <- table(predictions, car_test_value)
car_train_value <- df[1:100, 7]
car_test_value <- df[1501: 1728, 7]
predictions = knn(car_train, car_test, cl=car_train_value, k=3)
CrossTable(predictions, car_test_value,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
cm <- table(predictions, car_test_value)
sum(diag(cm))/sum(cm)
car_train <- df[1:1500, ]
car_test <- df[1501:1728, ]
car_train_value <- df[1:1500, 7]
car_test_value <- df[1501: 1728, 7]
predictions = knn(car_train, car_test, cl=car_train_value, k=3)
CrossTable(predictions, car_test_value,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE)
cm <- table(predictions, car_test_value)
sum(diag(cm))/sum(cm)
wbcdOriginal <- rcar
wbcdOriginal <- car
wbcdC <- scale(wbcdOriginal[-c(1,2)])
model <- kmeans(car, 2)
model$tot.withinss
table(wbcdOriginal$diagnosis, model$cluster )
df <- car
df$V1[df$V1=='vhigh'] <- 4
df$V1[df$V1=='high'] <- 3
df$V1[df$V1=='med'] <- 2
df$V1[df$V1=='low'] <- 1
df$V2[df$V2=='vhigh'] <- 4
df$V2[df$V2=='high'] <- 3
df$V2[df$V2=='med'] <- 2
df$V2[df$V2=='low'] <- 1
df$V3[df$V3=='5more'] <- 5
df$V4[df$V4=='more'] <- 5
df$V5[df$V5=='small'] <- 1
df$V5[df$V5=='med'] <- 2
df$V5[df$V5=='big'] <- 3
df$V6[df$V6=='low'] <- 1
df$V6[df$V6=='med'] <- 2
df$V6[df$V6=='high'] <-3
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
model <- kmeans(df, 3)
model$tot.withinss
install.packages("rattle")
library(rattle)
data(wine)
wineC <- as.data.frame(scale(wine[-1]))
set.seed(4)
model <- kmeans(wineC, 3)
model$size
model$tot.withinss
df$V7 <- NULL
model <- kmeans(df, 3)
model$tot.withinss
model <- kmeans(df, 4)
model$tot.withinss
# read the data
df <- car
summary(df)
# breaks plot(model)
df$V7 <- NULL
str(car)
# look at two characteristics of the applicant
table(car$V1)
table(car$V2)
credit_train <- df[1:900, ]
credit_test  <- df[901:1000, ]
# check the proportion of class variable
prop.table(table(credit_train$default))
prop.table(table(credit_test$default))
library(C50)
install.packages('C50')
model <- C5.0(default ~ ., data = credit_train)
library(C50)
install.packages('C50')
install.packages("C50")
# read the data
df <- car
summary(df)
# breaks plot(model)
df$V7 <- NULL
str(car)
# look at two characteristics of the applicant
table(car$V1)
table(car$V2)
help(table)
# look at the class variable
table(credit$default)
# create a random sample for training and test data
set.seed(1)
credit_rand <- credit[order(runif(1000)), ]
credit_train <- df[1:900, ]
credit_test  <- df[901:1000, ]
# check the proportion of class variable
prop.table(table(credit_train$default))
prop.table(table(credit_test$default))
library(C50)
model <- C5.0(default ~ ., data = credit_train)
# display simple facts about the tree
model
# only works if credit$job is dropped.
plot(model)
model <- C5.0(default ~ ., data = credit_train)
model <- C5.0(default ~ ., data = credit_train)
predictions <- predict(model, credit_test)
# install.packages("C50")
# install.packages("gmodels")
library(C50)
library(gmodels)
data(iris)
set.seed(2)
irisRand <- iris[order(runif(150)), ]
iris_train <- irisRand[1:125, ]
iris_test  <- irisRand[126:150, ]
prop.table(table(iris_train$Species))
prop.table(table(iris_test$Species))
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(Species ~ ., data = iris_train)
model
plot(model)
summary(model)
iris_predict <- predict(model, iris_test)
library(gmodels)
CrossTable(iris_predict, iris_test$Species,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
df <- car
set.seed(2)
irisRand <- df[order(runif(150)), ]
iris_train <- irisRand[1:125, ]
iris_test  <- irisRand[126:150, ]
prop.table(table(iris_train$V7))
prop.table(table(iris_test$V7))
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(Species ~ ., data = iris_train)
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(V7 ~ ., data = iris_train)
df <- car
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
set.seed(2)
irisRand <- df[order(runif(150)), ]
iris_train <- irisRand[1:125, ]
iris_test  <- irisRand[126:150, ]
prop.table(table(iris_train$V7))
prop.table(table(iris_test$V7))
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(V7 ~ ., data = iris_train)
model
plot(model)
summary(model)
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(V7 ~ ., data = iris_train)
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(df$V7 ~ ., data = iris_train)
df <- car
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
set.seed(2)
irisRand <- df[order(runif(150)), ]
iris_train <- irisRand[1:125, ]
iris_test  <- irisRand[126:150, ]
prop.table(table(iris_train$V7))
prop.table(table(iris_test$V7))
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(df$V7 ~ ., data = iris_train)
model <- C5.0(df ~ ., data = credit_train)
model <- C5.0(df$V7 ~ ., data = credit_train)
# look at the class variable
table(credit$default)
# look at the class variable
table(df$V7)
str(df)
str(randomCar)
df <- car
g <- runif(nrow(df))
randomCar <- iris[order(g), ]
str(randomCar)
df <- car
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
df <- car
df$V7[df$V7=="unacc"] <- 1
df$V7[df$V7=="acc"] <- 2
df$V7[df$V7=="good"] <- 3
df$V7[df$V7=="vgood"] <- 4
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
randomCar = as.data.frame(randomCar)
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
str(randomCar)
randomCar[,V7] <- lapply(randomCar[,V7] , factor)
randomCar[V7] <- lapply(randomCar[V7] , factor)
randomCar[randomCar$V7] <- lapply(randomCar[V7] , factor)
randomCar$V7 <- as.factor(randomCar$V7)
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
df <- car
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
randomCar <- as.data.frame(randomCar)
randomCar$V7 <- as.factor(randomCar$V7)
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
summary(model1)
plot(model1)
View(randomCar)
View(randomCar)
car_train <- df[1:1500, ]
car_test  <- df[1501:1728, ]
predictions <- predict(model1, car_test)
library(gmodels)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
table(credit_test, predictions)
df <- car
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
randomCar <- as.data.frame(randomCar)
randomCar$V7 <- as.factor(randomCar$V7)
car_train <- df[1:1500, ]
car_test  <- df[1501:1728, ]
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
summary(model1)
plot(model1)
predictions <- predict(model1, car_test)
library(gmodels)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
help(CrossTable)
table(car_test, predictions)
model1 <- C5.0(randomCar[1:278, -7], randomCar[1:278, 7])
summary(model1)
plot(model1)
predictions <- predict(model1, car_test)
table(car_test, predictions)
library(gmodels)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
table(car_test, predictions)
table(car_test, car_test)
str(predictions)
predictions <- predict(model1, car_test)
str(predictions)
str(car_test)
car_train <- randomCar[1:1500, ]
car_test  <- randomCar[1501:1728, ]
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
summary(model1)
plot(model1)
predictions <- predict(model1, car_test)
str(predictions)
str(car_test)
table(car_test, predictions)
table(car_test, predictions)
library(gmodels)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
table(credit_test, Predicted=predictions)
table(car_test, Predicted=predictions)
table(randomCar[1501:1728,7], Predicted=predictions)
table(randomCar[1501:1728,], Predicted=predictions)
7library(gmodels)
table(randomCar[1501:1728,7], Predicted=predictions)
car_test  <- randomCar[1501:1728, 7]
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
# install.packages("C50")
# install.packages("gmodels")
library(C50)
library(gmodels)
data(iris)
set.seed(2)
irisRand <- iris[order(runif(150)), ]
iris_train <- irisRand[1:125, ]
iris_test  <- irisRand[126:150, ]
prop.table(table(iris_train$Species))
prop.table(table(iris_test$Species))
#iris_model <- C5.0(iris_train[-5], iris_train$Species)
model <- C5.0(Species ~ ., data = iris_train)
model
plot(model)
summary(model)
iris_predict <- predict(model, iris_test)
library(gmodels)
CrossTable(iris_predict, iris_test$Species,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
table(iris_test, iris_predict)
model <- C5.0(V7 ~ ., data = car_train)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
car_test  <- randomCar[1501:1728,]
model <- C5.0(V7 ~ ., data = car_train)
predictions <- predict(model, car_test)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
df <- car
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
randomCar <- as.data.frame(randomCar)
randomCar$V7 <- as.factor(randomCar$V7)
car_train <- randomCar[1:1500, ]
car_test  <- randomCar[1501:1728,]
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
model <- C5.0(V7 ~ ., data = car_train)
df$V7[df$V7=="unacc"] <- 1
car <- read.csv("C:/Users/major/Downloads/car (2).data", header=FALSE)
View(car)
df <- car
g <- runif(nrow(df))
randomCar <- df[order(g), ]
str(randomCar)
randomCar <- as.data.frame(randomCar)
randomCar$V7 <- as.factor(randomCar$V7)
car_train <- randomCar[1:1500, ]
car_test  <- randomCar[1501:1728,]
model1 <- C5.0(randomCar[1:1500, -7], randomCar[1:1500, 7])
model <- C5.0(V7 ~ ., data = car_train)
summary(model1)
plot(model1)
predictions <- predict(model, car_test)
str(predictions)
str(car_test)
table(randomCar[1501:1728,7], Predicted=predictions)
library(gmodels)
CrossTable(predictions, car_test$default,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
str(predictions)
str(car_test)
CrossTable(predictions, car_test$V7,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted default', 'actual default'))
model$tot.withinss
df <- car
df$V1[df$V1=='vhigh'] <- 4
df$V1[df$V1=='high'] <- 3
df$V1[df$V1=='med'] <- 2
df$V1[df$V1=='low'] <- 1
df$V2[df$V2=='vhigh'] <- 4
df$V2[df$V2=='high'] <- 3
df$V2[df$V2=='med'] <- 2
df$V2[df$V2=='low'] <- 1
df$V3[df$V3=='5more'] <- 5
df$V4[df$V4=='more'] <- 5
df$V5[df$V5=='small'] <- 1
df$V5[df$V5=='med'] <- 2
df$V5[df$V5=='big'] <- 3
df$V6[df$V6=='low'] <- 1
df$V6[df$V6=='med'] <- 2
df$V6[df$V6=='high'] <-3
df$V7 <- NULL
model <- kmeans(df, 4)
model$tot.withinss
